{
  "name":"Gancsos Monitor Database Package",
  "versionString":"1.0.0",
  "version":"1",
  "versionServicePack":"0",
  "queries":
  [
    {
      "name":"MESSAGES",
      "query":"CREATE TABLE MESSAGES(MESSAGE_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT, MESSAGE_TEXT VARCHAR(4000) DEFAULT '', MESSAGE_LEVEL INT(3) DEFAULT '1', MESSAGE_CATEGORY INT(3) DEFAULT '1', LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP)",
      "packageName":"create"
    },
    {
      "name":"FLAGS",
      "query":"CREATE TABLE FLAGS(FLAG_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT, FLAG_NAME VARCHAR(120) NOT NULL, FLAG_VALUE VARCHAR(255), LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP)",
      "packageName":"create"
    },
    {
      "name":"USERS",
      "query":"CREATE TABLE USERS(USER_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT,USER_USERNAME VARCHAR(120) NOT NULL, USER_PASSWORD TEXT, USER_EMAIL VARCHAR(500) NOT NULL, USER_FIRSTNAME VARCHAR(120) NOT NULL, USER_LASTNAME VARCHAR(255) NOT NULL, USER_JSON TEXT, LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP, USER_STATE INT(1) DEFAULT '0')",
      "packageName":"create"
    },
    {   
      "name":"ACCOUNTS",
      "query":"CREATE TABLE ACCOUNTS(ACCOUNT_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT,ACCOUNT_USERNAME VARCHAR(120) NOT NULL, ACCOUNT_PASSWORD TEXT, ACCOUNT_NAME VARCHAR(500) NOT NULL, LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP)",
      "packageName":"create"
    },
    {
      "name":"ROLES",
      "query":"CREATE TABLE ROLES(ROLE_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT,ROLE_NAME VARCHAR(120) NOT NULL, LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP)",
      "packageName":"create"
    },
    {
      "name":"GROUPS",
      "query":"CREATE TABLE GROUPS (GROUP_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT, GROUP_LABEL VARCHAR(120) NOT NULL, LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP)",
      "packageName":"create"
    },
    {
      "name":"GROUP_MEMBERS",
      "query":"CREATE TABLE GROUP_MEMBERS (GROUP_ID INT(255), USER_ID INT(255), LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (GROUP_ID, USER_ID), FOREIGN KEY (GROUP_ID) REFERENCES GROUPS(GROUP_ID), FOREIGN KEY (USER_ID) REFERENCES USER(USER_ID))",
      "packageName":"create"
    },
    {
      "name":"SESSIONS",
      "query":"CREATE TABLE SESSIONS(SESSION_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT, SESSION_TOKEN VARCHAR(120) NOT NULL, USER_ID INT(255) NOT NULL, CREATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP, LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (USER_ID) REFERENCES USER(USER_ID))",
      "packageName":"create"
    },
    {
      "name":"AGENTS",
      "query":"CREATE TABLE AGENTS (AGENT_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT, AGENT_PUBLICIP VARCHAR(50) NOT NULL, AGENT_HOSTNAME VARCHAR(255) DEFAULT '', AGENT_PORT INT(10) DEFAULT '3435', AGENT_STATE INT(1) DEFAULT '0',  CREATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP, LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP)",
      "packageName":"create"
    },
    {
      "name":"MANAGEMENT_PACKS",
      "query": "CREATE TABLE MANAGEMENT_PACKS(MANAGEMENT_PACK_ID INT(255) NOT NULL PRIMARUY KEY AUTO_INCREMENT, MANAGEMENT_PACK_NAME VARCHAR(120) NOT NULL, MANAGEMENT_PACK_VERSION VARCHAR(30), MANAGEMENT_PACK_MANIFEST CLOB, LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP)",
      "packageName":"create"
    },
    {
      "name":"DATASOURCES",
      "query":"CREATE TABLE DATASOURCES(DATASOURCE_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT,DATASOURCE_LABEL VARCHAR(120) NOT NULL,DATASOURCE_TYPE INT(1) DEFAULT '0',DATASOURCE_MANIFEST CLOB,MANAGEMENT_PACK_ID INT(255),LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,FOREIGN KEY(MANAGEMENT_PACK_ID) REFERENCES MANAGEMENT_PACK(MANAGEMENT_PACK_ID));",
      "packageName":"create"
    },
    {
      "name":"RULES",
      "query":"CREATE TABLE RULES (RULE_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT, RULE_LABEL VARCHAR(120) NOT NULL, RULE_TYPE INT(1) DEFAULT '0', RULE_MANIFEST CLOB, MANAGEMENT_PACK_ID INT(255), LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (MANAGEMENT_PACK_ID) REFERENCES MANAGEMENT_PACK(MANAGEMENT_PACK_ID));",
      "packageName":"create"
    },
    {
      "name":"DISCOVERIES",
      "query":"CREATE TABLE DISCOVERY(DISCOVERY_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT,DISCOVERY_LABEL VARCHAR(120) NOT NULL,DISCOVERY_TYPE INT(1) DEFAULT '0',DISCOVERY_MANIFEST CLOB,MANAGEMENT_PACK_ID INT(255),LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,FOREIGN KEY(MANAGEMENT_PACK_ID) REFERENCES MANAGEMENT_PACK(MANAGEMENT_PACK_ID));",
      "packageName":"create"
    },
    {
      "name":"MONITORS",
      "query":"CREATE TABLE MONITORS (MONITOR_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT, MONITOR_LABEL VARCHAR(120) NOT NULL, MONITOR_TYPE INT(1) DEFAULT '0', MONITOR_MANIFEST CLOB, MANAGEMENT_PACK_ID INT(255), LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (MANAGEMENT_PACK_ID) REFERENCES MANAGEMENT_PACK(MANAGEMENT_PACK_ID));",
      "packageName":"create"
    },
    {
      "name":"MONITOR_RUNS",
      "query":"CREATE TABLE MONITOR_RUNS (MONITOR_RUN_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT, MONITOR_ID INT(255) NOT NULL, INPUT_MANIFEST CLOB, RESPONSE_MANIFEST CLOB, LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREGIN KEY(MONITOR_ID) REFERENCES MONITORS(MONITOR_ID))",
      "packageName":"create"
    },
	{
      "name":"DISCOVERY_RUNS",
      "query":"CREATE TABLE DISCOVERY_RUNS (DISCOVERY_RUN_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT, DISCOVERY_ID INT(255) NOT NULL, INPUT_MANIFEST CLOB, RESPONSE_MANIFEST CLOB, LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREGIN KEY(DISCOVERY_ID) REFERENCES DISCOVERIES(DISCOVERY_ID))",
      "packageName":"create"
    },
    {
      "name":"RULE_RUNS",
      "query":"CREATE TABLE RULE_RUNS (RULE_RUN_ID INT(255) NOT NULL PRIMARY KEY AUTO_INCREMENT, RULE_ID INT(255) NOT NULL, INPUT_MANIFEST CLOB, RESPONSE_MANIFEST CLOB, LAST_UPDATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREGIN KEY(RULE_ID) REFERENCES RULES(RULE_ID))",
      "packageName":"create"
    },
    {
      "name":"Add user group",
      "query":"INSERT INTO GROUPS(GROUP_LABEL) VALUES ('USERS')",
      "packageName":"create"
    },
    {
      "name":"Add admin group",
      "query":"INSERT INTO GROUPS(GROUP_LABEL) VALUES ('ADMINISTRATORS')",
      "packageName":"create"
    },
    {
      "name":"Add system group",
      "query":"INSERT INTO GROUPS(GROUP_LABEL) VALUES ('SYSTEM')",
      "packageName":"create"
    }
  ]
}

